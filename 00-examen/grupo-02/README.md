# grupo-02 â€” Gatolate â‚ŠËšâŠ¹á°”

Integrantes: 
 - 01-[antokiaraa](https://github.com/antokiaraa/)
 - 16-[javieramoraga-rgb](https://github.com/javieramoraga-rgb/)
 - 18-[ppia97](https://github.com/ppia97/)

## IntroducciÃ³n .â˜˜ï¸Ž ÝË–
En este proyecto buscamos explorar cÃ³mo una emociÃ³n, que normalmente es invisible, puede **tomar forma a travÃ©s de una mÃ¡quina.** Trabajamos con la figura literaria de **prosopopeya**, por lo que decidimos darle vida a cuatro gatitos que reaccionan como si fueran personas.
La idea es representar cÃ³mo la ansiedad aparece frente a un estÃ­mulo cotidiano (en este caso, un â€œmetroâ€ que se acerca) y cÃ³mo esa sensaciÃ³n puede contagiarse a otros, casi sin darnos cuenta. Cuando el metro entra en escena, el primer gato empieza a vibrar, como si algo dentro de Ã©l se activara. Luego los demÃ¡s lo siguen, mostrando cÃ³mo las emociones se transmiten en cadena dentro de un mismo ambiente.
MÃ¡s que una mÃ¡quina funcional, lo que construimos es una **pequeÃ±a metÃ¡fora fÃ­sica: un grupo de figuritas que â€œsientenâ€ y reaccionan, usando vibraciÃ³n para mostrar lo que a veces nos cuesta expresar.** Nuestro objetivo es que esta escena nos haga mirar las **emociones silenciosas** desde otro lugar, entendiendo que incluso lo mÃ¡s cotidiano puede desencadenar reacciones profundas, tanto en nosotros como en quienes nos rodean.

## Significado de figura literaria. â˜˜ï¸Ž ÝË–

### â¤· Prosopopeya (tambiÃ©n llamada personificaciÃ³n): 
> Hablamos de prosopopeya, al **atribuir propiedades humanas** a un referente que normalmente carece de ellas, como un animal, una planta o un objeto inanimado.

## Significado de emociÃ³n. â˜˜ï¸Ž ÝË–

### â¤· Ansiedad:
> Es un estado de **anticipaciÃ³n y alerta constante**. No siempre ocurre algo, pero el cuerpo actÃºa como si algo estuviera por pasar. Se manifiesta en forma de tensiÃ³n, latido rÃ¡pido, vibraciÃ³n o inquietud permanente. No descansa del todo.
Esta emociÃ³n casi nunca se explica hablando; se expresa **con gestos, posturas y reacciones corporales**. Por eso, nuestras mÃ¡quinas **no hablan, se comportan.**

â”€â”€â”€â”€ à­¨à­§ â”€â”€â”€â”€

## PlanificaciÃ³n y proceso previo ð“² à¹‹à£­ à£ª Ë–ðŸŽ

### Primera fase del proyecto â€” Entrega anterior.
En la primera etapa del proyecto definimos la emociÃ³n que iba a representar nuestras mÃ¡quinas (ansiedad) y exploramos cÃ³mo podrÃ­a expresarse mediante movimientos, ademÃ¡s de descartar la idea de dos mÃ¡quinas distintas con distintas emociones. Probamos distintos componentes, hicimos los primeros prototipos y descubrimos varias limitaciones que nos obligaron a ajustar ideas y cambiar algunos elementos del diseÃ±o. Aunque muchas cosas fueron cambiando despuÃ©s, esta fase inicial fue clave para entender la direcciÃ³n del proyecto y construir las bases de lo que desarrollamos mÃ¡s adelante.
[Fotos primera entrega, gatitos en caja y todo lo referente a eso]
### Fase actual â€” Toma de decisiones, desarrollo y montaje.
En la fase actual, tomamos decisiones en base al proyecto anterior, como orientar el proyecto a 4 mÃ¡quinas mÃ¡s pequeÃ±as y simples que compartirÃ¡n comportamiento en un determinado escenario (decidimos ocupar el metro), descartamos el uso de LED, ademÃ¡s de ya darle un sentido mucho mÃ¡s especÃ­fico al querer **representar una emociÃ³n en un entorno cotidiano, que muchos de nosotros vivimos diariamente.**
### PlanificaciÃ³n.
â‹† ð™š ÌŠ. DÃ­a 1 â€” PlanificaciÃ³n y CotizaciÃ³n.
- Trabajo teÃ³rico, sin hardware.
- OrganizaciÃ³n de componentes, links y precios.
- Boceto del circuito (explicaciÃ³n y diagrama).
- RedacciÃ³n del resumen del proyecto y objetivos.
- DefiniciÃ³n estÃ©tica de la maqueta: referencias del metro, medidas de la base y de los gatos, cotizaciÃ³n/encargo de impresiÃ³n 3D.
- PreparaciÃ³n del cÃ³digo base sin motores:
- Lectura del sensor HC-SR04
- SimulaciÃ³n del â€œcontagio de ansiedadâ€ con delays
- Meta del dÃ­a: dejar todo listo para ejecutar en el siguiente dÃ­a.

â‹† ð™š ÌŠ.  DÃ­a 2 â€” Maqueta 3D, DocumentaciÃ³n y CÃ³digo sin motores

- CreaciÃ³n del README inicial: descripciÃ³n, concepto, metÃ¡fora, esquema.
- GeneraciÃ³n del diagrama inicial del circuito.
- Modelado o ediciÃ³n de los STL: gatos y base tipo metro.
- EnvÃ­o de archivos a impresiÃ³n 3D y definiciÃ³n de colores/materiales.
- CodificaciÃ³n de la lÃ³gica en cadena (sin motores):
- ActivaciÃ³n secuencial de gatos segÃºn distancia
- Ajustes de tiempos y PWM simulado
- Meta del dÃ­a: maqueta en proceso, cÃ³digo avanzado y documentaciÃ³n ordenada.

â‹† ð™š ÌŠ. DÃ­a 3 â€” IntegraciÃ³n de Motores 
- Cableado completo del circuito real.
Prueba individual de cada MOSFET con su motor.
- Etiquetado del cableado (Gato 1, Gato 2, etc.).
- Pintura/acabado de piezas impresas y definiciÃ³n de espacios para motores. 
- IntegraciÃ³n de motores al cÃ³digo:
Ajuste de PWM real
- Prueba de la secuencia de vibraciÃ³n
- Meta del dÃ­a: circuito funcional y primeras pruebas fÃ­sicas.
â‹† ð™š ÌŠ. DÃ­a 4 â€” Montaje Final
- Montaje de motores dentro de los gatos y asegurado de cableado.
- FijaciÃ³n de MOSFETs en la base.
- Ensamblaje visual: paneles del metro, piso, seÃ±alÃ©ticas. 
- Pruebas completas con todo integrado:
- Sensibilidad del ultrasÃ³nico
- Tiempos de contagio
- Meta del dÃ­a: maqueta completamente funcional.
â‹† ð™š ÌŠ. DÃ­a 5 â€” DocumentaciÃ³n Final y Entrega
- RedacciÃ³n final en GitHub:
- IntroducciÃ³n
- JustificaciÃ³n
- Prosopopeya
- Materiales
- Diagrama final
- Otros
- Subida de fotos y videos del proyecto.
- Formateo del cÃ³digo, comentarios y subida al repositorio.
- Meta del dÃ­a: proyecto listo para entrega.
â”€â”€â”€â”€ à­¨à­§ â”€â”€â”€â”€
## Diagrama de Flujo
```mermaid
flowchart TD
    A[Inicio] --> B[Encender Arduino]
    B --> C[Esperar lectura del sensor HC-SR04]

    C --> D{Â¿Distancia menor al umbral?}

    D -- SÃ­ --> E[Activar Gato 1:<br>vibraciÃ³n + LED parpadeo]
    E --> F[Esperar breve delay emocional]
    F --> G[Activar Gato 2]
    G --> H[Activar Gato 3]
    H --> I[Activar Gato 4]

    D -- No --> J[Mantener todos los gatitos en reposo]

    I --> K[Escena completa activa]
    J --> C
    K --> L{Â¿EstÃ­mulo sigue presente?}

    L -- SÃ­ --> C
    L -- No --> M[Desactivar vibraciÃ³n y LEDs gradualmente]

    M --> C
```
###  Â¿QuÃ© representa este diagrama?
- **Los gatitos no se activan todos a la vez**, sino en **cadena**, siguiendo la metÃ¡fora emocional.  
- El **primer gatito** reacciona al sensor.  
- Los demÃ¡s se activan despuÃ©s, como si la ansiedad se **contagiara**.  
- Si el estÃ­mulo desaparece, todo el sistema vuelve **gradualmente** a la calma (sin apagarse de golpe).  
â”€â”€â”€â”€ à­¨à­§ â”€â”€â”€â”€
## Bill of Materials (BOM) à¹‹ à£­ â­‘

### Componentes ElectrÃ³nicos â‹† ð™š ÌŠ.

| Elemento | Cantidad | Â¿Para quÃ© sirve? |
|---------|----------|------------------|
| **Arduino UNO o Nano** | 1 | Controla los 5 gatos, los motores y el sensor. Uno basta para todo el sistema. |
| **Motores vibradores joystick**| 4 | Permiten el temblor/vibraciÃ³n de cada gato. |
| **Sensor ultrasÃ³nico HC-SR04** | 1 | Detecta la cercanÃ­a del usuario (disparador de la ansiedad). |
| **Protoboard grande** | 1 | Para armar todo el circuito de manera centralizada. |
| **Cables Dupont (M-M / M-H)** | Muchos | Cableado de motores y sensor. |
| **MÃ³dulo MOSFET 15A 400W PWM** | 5 | Controla la vibraciÃ³n y potencia de cada motor N20. |

### Maqueta + Montaje â‹† ð™š ÌŠ.
| Elemento | Cantidad | Â¿Para quÃ© sirve? |
|---------|----------|------------------|
| **Filamento PLA (1 kg)** | 1 | ImpresiÃ³n 3D de gatos, bases y soportes. |
| **CartÃ³n pluma / MDF delgado** | 1 | ConstrucciÃ³n del piso y paredes de la maqueta. |
| **Silicona caliente / Pegamento / Cinta** | â€” | Fijar motores y piezas. |

## 2. Tabla de Costos (Estimados AFEL) â‹† ð™š ÌŠ.
| Ãtem | Cantidad | Precio Unitario | Total |
|------|----------|------------------|--------|
| Motor vibrador  joystick | 4 | $0 | $0 |
| Sensor ultrasÃ³nico HC-SR04 | 1 | $0 | $0 |
| Protoboard | 1 | $0 | $0 |
| Resistencias 220Î© | 10 | $0 | $0 |
| LEDs de color | 10 | $0 | $0 |
| Cables Dupont | 1 pack | $0 | $0 |
| CartÃ³n pluma / MDF | 1 | $3.000 | $3.000 |
| MÃ³dulo MOSFET 15A 400W PWM | 5 | $1.200 | $4.800 |
## Total gastado: $7.800 CLP
>  Este total corresponde Ãºnicamente al gasto real del grupo.  
> Muchos componentes fueron aportados por el laboratorio o ya estaban en posesiÃ³n del equipo.
> Terminamos descartando el uso de los LEDS.

## Links de compra à¹‹ à£­ â­‘

A continuaciÃ³n se incluyen los enlaces de compra mencionados en el proceso.

### MÃ³dulo MOSFET 15A / 400W PWM  
https://afel.cl/products/modulo-mosfet-15a-400w-pwm 

### Cables HH
https://afel.cl/products/pack-20-cables-de-conexion-hembra-hembra?_pos=2&_sid=79ff9b6a9&_ss=r 

### Sensores ultrasÃ³nicos HC-SR04  
https://afel.cl/products/sensor-de-ultrasonico-hc-sr04 

### LED RGB 5mm  
https://afel.cl/products/diodo-led-rgb-5mm 

> Los motores N20 ya estaban en posesiÃ³n del grupo, por lo que no los compramos.


â”€â”€â”€â”€ à­¨à­§ â”€â”€â”€â”€

## Gatitos Ansiedad â€” Comportamiento â‰½^- Ë• -^â‰¼
**Cuando el â€œmetroâ€ se acerca**, el primer gatito es el que detecta el estÃ­mulo:
- Comienza a vibrar de forma notoria.
- Su LED empieza a parpadear, mostrando el aumento de tensiÃ³n.


**Cuando el primer gatito se activa**, los demÃ¡s comienzan a contagiarse emocionalmente:
- El segundo gatito vibra poco despuÃ©s.
- El tercero y cuarto siguen la cadena, como si la ansiedad se expandiera.
- Cada uno suma un ligero desfase, imitando cÃ³mo una emociÃ³n se propaga en un espacio compartido.


**Si el metro estÃ¡ muy cerca o la presencia es intensa**, la escena completa entra en un estado de ansiedad elevada:
- Los cuatro gatitos vibran con mayor intensidad.
- Los LEDs mantienen un parpadeo irregular, mÃ¡s rÃ¡pido.


**Cuando el estÃ­mulo se aleja**, los gatitos entran en un periodo de â€œdesactivaciÃ³n emocionalâ€:
- La vibraciÃ³n disminuye gradualmente.
- El LED tarda unos segundos en volver a un parpadeo lento o apagarse.
- No vuelven al reposo inmediatamente, dejando un pequeÃ±o â€œresiduo emocionalâ€.
â”€â”€â”€â”€ à­¨à­§ â”€â”€â”€â”€

## Recomendaciones â€¼
- MantÃ©n el sensor ultrasÃ³nico con vista despejada hacia la maqueta del â€œmetroâ€ para evitar activaciones falsas.
- Asegura bien los motores vibradores joystick dentro de cada gatito para que la vibraciÃ³n sea clara y no se suelten.
- Evita bloquear o mover los gatitos mientras estÃ¡n vibrando, ya que puede desajustar su comportamiento.
- Coloca la maqueta sobre una superficie firme para que la vibraciÃ³n no se disperse.
## Contexto de Uso  â‹† ð™š ÌŠ.
Esta instalaciÃ³n estÃ¡ pensada para mostrarse en un **espacio controlado**, como una sala de clases, laboratorio o exposiciÃ³n. El pÃºblico observa cÃ³mo el â€œmetroâ€ se acerca a la maqueta y cÃ³mo los gatitos reaccionan en cadena con vibraciÃ³n. 
El objetivo es que **"el espectador pueda interpretar la emociÃ³n de ansiedad a travÃ©s del comportamiento de las figuras**, entendiendo cÃ³mo un estÃ­mulo cotidiano puede influir en todos los que comparten un mismo entorno.
â”€â”€â”€â”€ à­¨à­§ â”€â”€â”€â”€
## Desarrollo del circuito âŠ¹ à£ª Ë–
###  CIRCUITO COMPLETO

### A) AlimentaciÃ³n General

- Los **motores vibradores joystick y los mÃ³dulos MOSFET NO se alimentan desde el Arduino**.  
- El Arduino solo **controla**, no alimenta los motores.
- Se utiliza una **fuente externa de 6â€“9V** para todos los motores.
- El Arduino se alimenta por **USB**.

####  Requisito crÃ­tico: **GND comÃºn**
Debes unir todos los GND:

- GND de la fuente externa  
- GND del Arduino  
- GND de cada mÃ³dulo MOSFET  

> Sin GND comÃºn, el circuito **no funcionarÃ¡**.

---

### B) ConexiÃ³n del Sensor UltrasÃ³nico HC-SR04

| Pin del Sensor | ConexiÃ³n |
|----------------|----------|
| **VCC** | 5V del Arduino |
| **GND** | GND comÃºn |
| **TRIG** | Pin digital **D8** |
| **ECHO** | Pin digital **D9** |

[Foto de la conexiÃ³n de sensor HC]

---

### C) Motores N20 + MÃ³dulos MOSFET  
Cada gato utiliza **1 motor vibradores joystick** y **1 mÃ³dulo MOSFET**.  
Esto permite activar cada motor de forma independiente y en secuencia (efecto â€œcontagioâ€).

#### ConexiÃ³n por cada motor:

1. **AlimentaciÃ³n del mÃ³dulo MOSFET**
   - +V del mÃ³dulo â†’ +6â€“9V de la fuente  
   - GND del mÃ³dulo â†’ GND comÃºn  

2. **Motor**
   - Motor **+** â†’ +6â€“9V de la fuente  
   - Motor **â€“** â†’ **OUTâ€“** del MOSFET  
   *(El MOSFET abre/cierra el camino negativo del motor.)*

[Foto conexiÃ³n del motor]

3. **SeÃ±al de control (PWM)**
   - Pin SIGNAL del MOSFET â†’ Pin PWM del Arduino  
   - GND del MOSFET â†’ GND del Arduino (ya comÃºn)

#### DistribuciÃ³n de pines recomendada:

| Gato | MOSFET | Pin PWM del Arduino |
|------|--------|----------------------|
| **Gato 1** | MOSFET 1 | **D3** |
| **Gato 2** | MOSFET 2 | **D5** |
| **Gato 3** | MOSFET 3 | **D6** |
| **Gato 4** | MOSFET 4 | **D10** |
| **Gato 5** | MOSFET 5 | **D11** |

---

### D) ConexiÃ³n de los LEDs

- Ãnodo (pierna larga) â†’ **Pin digital del Arduino**  
- CÃ¡todo (pierna corta) â†’ **Resistencia 220Î©** â†’ GND  

[Foto conexiÃ³n de los LED]

| LED | Pin Arduino |
|------|-------------|
| **LED Gato 1** | D2 |
| **LED Gato 2** | D4 |
| **LED Gato 3** | D7 |
| **LED Gato 4** | D12 |
| **LED Gato 5** | D13 |

---

### E) Resumen Visual



### F) Â¿Por quÃ© funciona este circuito?

- El **sensor ultrasÃ³nico** detecta la distancia del â€œmetroâ€.
- El **Arduino interpreta esa informaciÃ³n** y activa el primer gatito.
- Cada MOSFET controla de forma independiente la vibraciÃ³n de cada motor.
- La secuencia de activaciÃ³n crea el **efecto emocional de contagio**.
- Los LEDs refuerzan visualmente el nivel de ansiedad en cada gato.

### G) Seguridad MÃ­nima 

- **TODOS los GND deben estar unidos.**  
- Los motores **jamÃ¡s** deben alimentarse desde el Arduino.  
- Usar siempre **fuente externa de 6â€“9V** para los motores.  
- Asegurar bien los cables (la vibraciÃ³n puede soltarlos).  
- AÃ±adir un capacitor grande (recomendado **470ÂµF** entre +6â€“9V y GND) para evitar reinicios inesperados del Arduino.

### PseudocÃ³digo
Â´Â´Â´cpp
/* =============================================================
   PROYECTO: "Gatitos en Ansiedad" â€“ ReacciÃ³n al Metro Cercano
   VERSIÃ“N: Arduino UNO R4
   DESCRIPCIÃ“N GENERAL:

   El sistema controla 4 gatitos que vibran cuando un tren del metro
   se acerca. La proximidad es detectada por un sensor ultrasÃ³nico.

   Cuando la distancia medida es suficientemente corta,
   los gatitos se activan uno por uno:
        Gato 1 â†’ Gato 2 â†’ Gato 3 â†’ Gato 4

   Si el metro se aleja, los gatitos se calman lentamente.
================================================================ */
// ================================================================================
// DEFINICIÃ“N DE PINES
// AquÃ­ definimos los pines de cada motor y sensor ultrasÃ³nico para que todo quede ordenado.
// Si cambia un cable fÃ­sico, solo editar estos valores.
// ================================================================================

Definir pin_trig = 8
Definir pin_echo = 9

Definir motor_gato1 = 3
Definir motor_gato2 = 5
Definir motor_gato3 = 6
Definir motor_gato4 = 10

// ================================================================================
//PARÃMETROS Y VARIABLES GENERALES
// ================================================================================

Definir duracion_pulso como entero largo
Definir distancia_cm como entero

Definir umbral_activacion = 20   // distancia donde comienza la ansiedad


// ================================================================================
// FunciÃ³n: medirDistancia()
//Convierte un eco ultrasÃ³nico en centÃ­metros reales.
// ================================================================================

funciÃ³n medirDistancia():

    Escribir LOW en pin_trig
    Esperar 2 microsegundos

    Escribir HIGH en pin_trig
    Esperar 10 microsegundos
    Escribir LOW en pin_trig

    Leer duracion_pulso = tiempo HIGH en pin_echo (timeout 25 ms)

    SI duracion_pulso = 0 ENTONCES
        retornar -1   // no se detectÃ³ nada
    FIN SI

    distancia = duracion_pulso * 0.034 / 2

    retornar distancia
fin funciÃ³n

// ================================================================================
//FunciÃ³n activarGatoX()
//Cada gato vibra con distinta intensidad emocional.
// ================================================================================

funciÃ³n activarGato1():
    escribir PWM 255 en motor_gato1
fin funciÃ³n

funciÃ³n activarGato2():
    escribir PWM 200 en motor_gato2
fin funciÃ³n

funciÃ³n activarGato3():
    escribir PWM 170 en motor_gato3
fin funciÃ³n

funciÃ³n activarGato4():
    escribir PWM 150 en motor_gato4
fin funciÃ³n


// ================================================================================
//FunciÃ³n desactivarGradual()
//Simula que los gatitos se calman poco a poco.
// ================================================================================
funciÃ³n desactivarGradual():

    para nivel desde 255 hasta 0, restando 15:

        escribir PWM nivel      en motor_gato1
        escribir PWM nivel*0.8  en motor_gato2
        escribir PWM nivel*0.6  en motor_gato3
        escribir PWM nivel*0.5  en motor_gato4

        esperar 40 ms
    fin para

fin funciÃ³n

// ================================================================================
//FunciÃ³n apagarTodosLosGatos()
//Apaga todos los motores al inicio.
// ================================================================================

funciÃ³n apagarTodosLosGatos():
    escribir PWM 0 en motor_gato1
    escribir PWM 0 en motor_gato2
    escribir PWM 0 en motor_gato3
    escribir PWM 0 en motor_gato4
fin funciÃ³n

// ================================================================================
//SETUP - se ejecuta una sola vez
// ================================================================================

funciÃ³n setup():

    Configurar pin_trig como SALIDA
    Configurar pin_echo como ENTRADA

    Configurar motores como SALIDA:
        motor_gato1
        motor_gato2
        motor_gato3
        motor_gato4

    Llamar apagarTodosLosGatos()

    Iniciar monitor serial a 9600

fin funciÃ³n

// ================================================================================
//LOOP PRINCIPAL
//LÃ³gica emocional del sistema: detectar â†’ activar â†’ calmar.
// ================================================================================

funciÃ³n loop():

    distancia_cm = medirDistancia()

    Imprimir "Distancia:" y distancia_cm

    SI distancia_cm > 0 Y distancia_cm â‰¤ umbral_activacion ENTONCES
        
        activarGato1()
        esperar 300 ms

        activarGato2()
        esperar 300 ms

        activarGato3()
        esperar 300 ms

        activarGato4()

    SINO

        desactivarGradual()

    FIN SI

fin funciÃ³n

Â´Â´Â´

### carcasa

Para carcasa, tenemos 4 gatitos modelados en 3D impresos en PLA blanco, los cuales dentro llevarÃ¡n cada uno su motor correspondiente. 

[Fotos modelado gatitos + gatitos finales]

AdemÃ¡s, un modelo de metro que tambiÃ©n fue impreso y dentro lleva el sensor ultrasÃ³nico. Usamos como base el modelo de [https://cults3d.com/es/modelo-3d/artilugios/metro] que fue modificado por nosotras para que pudiera abrirse en dos piezas y llevara los componentes por dentro. 

[fotos modelado metro + metro final]

### CÃ³digo explicado
Pines y variables
Â´Â´Â´cpp
// ---------------------------------------------
// Proyecto: Gatitos en Ansiedad
// VersiÃ³n: Arduino UNO R4 
// DescripciÃ³n:
// Este cÃ³digo controla 4 gatitos que â€œsientenâ€ ansiedad
// cuando el metro se acerca. Se activa por un sensor
// ultrasÃ³nico y vibra con motores controlados por MOSFET.
// ---------------------------------------------

// ----------- PINES DEL SENSOR ---------------
int pin_trig = 8;
int pin_echo = 9;

// ----------- PINES DE MOTORES (MOSFET) ------
// Estos pines mandan la seÃ±al PWM al MOSFET.
// No alimentan el motor, solo lo controlan.
int motor_gato1 = 3;
int motor_gato2 = 5;
int motor_gato3 = 6;
int motor_gato4 = 10;

// ----------- VARIABLES GENERALES ------------
long duracion_pulso = 0;
int distancia_cm = 0;

// Esta es la distancia lÃ­mite donde â€œel metroâ€ ya estÃ¡ encima.
int umbral_activacion = 20; // cm
Â´Â´Â´

En este bloque se declaran todos los pines que usarÃ¡ Arduino:
-Pines del sensor ultrasÃ³nico
-Pines de los motores que controlan a los 4 gatitos
-Variables que guardan la duraciÃ³n del pulso y la distancia
-El umbral que define cuÃ¡ndo empieza la â€œansiedadâ€
Este bloque solo prepara nombres para que el resto del cÃ³digo sea mÃ¡s fÃ¡cil de entender.


setup(): preparaciÃ³n del sistema
Â´Â´Â´cpp
void setup() {

  // Configuramos el sensor ultrasÃ³nico
  pinMode(pin_trig, OUTPUT);
  pinMode(pin_echo, INPUT);

  // Motores (control PWM hacia el MOSFET)
  pinMode(motor_gato1, OUTPUT);
  pinMode(motor_gato2, OUTPUT);
  pinMode(motor_gato3, OUTPUT);
  pinMode(motor_gato4, OUTPUT);

  // Dejamos todo apagado al inicio
  apagarTodosLosGatos();

  Serial.begin(9600);
}

Â´Â´Â´
Este bloque prepara todo al encender Arduino:
-Configura pines de sensor y motores
-Inicializa el Serial
-Apaga los motores para que los gatitos comiencen calmados
Es la fase de preparaciÃ³n, se ejecuta solo una vez.


loop(): comportamiento principal
Â´Â´Â´cpp
void loop() {

  distancia_cm = medirDistancia();

  Serial.print("Distancia: ");
  Serial.println(distancia_cm);

  // Si el metro estÃ¡ cerca, comienza la ansiedad
  if (distancia_cm > 0 && distancia_cm <= umbral_activacion) {

    activarGato1();
    delay(300); // pequeÃ±a "duda" emocional

    activarGato2();
    delay(300);

    activarGato3();
    delay(300);

    activarGato4();

  } else {
    // AquÃ­ los gatitos se van calmando de a poco
    desactivarGradual();
  }

}

Â´Â´Â´
AquÃ­ ocurre el comportamiento â€œemocionalâ€:
-Se mide la distancia con el ultrasÃ³nico.
-Si el metro estÃ¡ cerca (distancia â‰¤ umbral):
-Los 4 gatitos se activan uno por uno, con una pausa entre ellos.


-Si el metro no estÃ¡ cerca:
-Se ejecuta una calma progresiva que baja la vibraciÃ³n lentamente.


Este bloque decide si los gatitos entran en ansiedad o relajaciÃ³n.


 Funciones auxiliares
Â´Â´Â´cpp
// ---------------------------------------------------------
// FUNCIONES DEL SENSOR
// ---------------------------------------------------------

int medirDistancia() {

  // Disparo corto para iniciar el sensor
  digitalWrite(pin_trig, LOW);
  delayMicroseconds(2);
  digitalWrite(pin_trig, HIGH);
  delayMicroseconds(10);
  digitalWrite(pin_trig, LOW);

  // Leemos el tiempo del pulso
  duracion_pulso = pulseIn(pin_echo, HIGH, 25000); // timeout 25ms

  // Si no detectÃ³ nada, devolvemos -1
  if (duracion_pulso == 0) return -1;

  // Convertimos el tiempo a distancia
  int distancia = duracion_pulso * 0.034 / 2;
  return distancia;
}



// ---------------------------------------------------------
// FUNCIONES DE ACTIVACIÃ“N DE GATOS
// ---------------------------------------------------------

void activarGato1() {
  // Motor fuerte â†’ gato que detecta el peligro primero
  analogWrite(motor_gato1, 255);  
}

void activarGato2() {
  analogWrite(motor_gato2, 200);  
}

void activarGato3() {
  analogWrite(motor_gato3, 170);
}

void activarGato4() {
  analogWrite(motor_gato4, 150);
}



// ---------------------------------------------------------
// DESACTIVACIÃ“N LENTA: los gatitos no se calman al tiro
// ---------------------------------------------------------

void desactivarGradual() {

  // Vamos bajando la vibraciÃ³n poquito a poco
  for (int nivel = 255; nivel >= 0; nivel -= 15) {

    analogWrite(motor_gato1, nivel);
    analogWrite(motor_gato2, nivel * 0.8);
    analogWrite(motor_gato3, nivel * 0.6);
    analogWrite(motor_gato4, nivel * 0.5);

    delay(40); // este delay suave da sensaciÃ³n de "calma"
  }
}



// ---------------------------------------------------------
// FUNCIÃ“N PARA APAGAR TODO AL INICIO
// ---------------------------------------------------------

void apagarTodosLosGatos() {
  analogWrite(motor_gato1, 0);
  analogWrite(motor_gato2, 0);
  analogWrite(motor_gato3, 0);
  analogWrite(motor_gato4, 0);
}

Â´Â´Â´
Este bloque contiene todas las funciones que apoyan al loop:
-medirDistancia(): usa el ultrasÃ³nico y devuelve la distancia en cm.
-activarGato1â€“4(): encienden cada motor con distinta intensidad.
-desactivarGradual(): baja la vibraciÃ³n poco a poco (efecto de â€œcalmaâ€).
-apagarTodosLosGatos(): apaga todos al inicio.
Son funciones que ordenan el cÃ³digo y separan tareas.


###  CÃ³digo completo

Â´Â´Â´cpp
// ---------------------------------------------
// Proyecto: Gatitos en Ansiedad
// VersiÃ³n: Arduino UNO R4
// DescripciÃ³n:
// Este cÃ³digo controla 4 gatitos que â€œsientenâ€ ansiedad
// cuando el metro se acerca. Se activa por un sensor
// ultrasÃ³nico y vibra con motores controlados por MOSFET.
// ---------------------------------------------

// ----------- PINES DEL SENSOR ---------------
int pin_trig = 8;
int pin_echo = 9;

// ----------- PINES DE MOTORES (MOSFET) ------
// Estos pines mandan la seÃ±al PWM al MOSFET.
// No alimentan el motor, solo lo controlan.
int motor_gato1 = 3;
int motor_gato2 = 5;
int motor_gato3 = 6;
int motor_gato4 = 10;

// ----------- VARIABLES GENERALES ------------
long duracion_pulso = 0;
int distancia_cm = 0;

// Esta es la distancia lÃ­mite donde â€œel metroâ€ ya estÃ¡ encima.
int umbral_activacion = 20; // cm

void setup() {

  // Configuramos el sensor ultrasÃ³nico
  pinMode(pin_trig, OUTPUT);
  pinMode(pin_echo, INPUT);

  // Motores (control PWM hacia el MOSFET)
  pinMode(motor_gato1, OUTPUT);
  pinMode(motor_gato2, OUTPUT);
  pinMode(motor_gato3, OUTPUT);
  pinMode(motor_gato4, OUTPUT);

  // Dejamos todo apagado al inicio
  apagarTodosLosGatos();

  Serial.begin(9600);
}


// ---------------------------------------------------------------
// LOOP PRINCIPAL: aquÃ­ se decide todo el comportamiento emocional
// ---------------------------------------------------------------

void loop() {

  distancia_cm = medirDistancia();

  Serial.print("Distancia: ");
  Serial.println(distancia_cm);

  // Si el metro estÃ¡ cerca, comienza la ansiedad
  if (distancia_cm > 0 && distancia_cm <= umbral_activacion) {

    activarGato1();
    delay(300); // pequeÃ±a "duda" emocional

    activarGato2();
    delay(300);

    activarGato3();
    delay(300);

    activarGato4();

  } else {
    // AquÃ­ los gatitos se van calmando de a poco
    desactivarGradual();
  }

}



// ---------------------------------------------------------
// FUNCIONES DEL SENSOR
// ---------------------------------------------------------

int medirDistancia() {

  // Disparo corto para iniciar el sensor
  digitalWrite(pin_trig, LOW);
  delayMicroseconds(2);
  digitalWrite(pin_trig, HIGH);
  delayMicroseconds(10);
  digitalWrite(pin_trig, LOW);

  // Leemos el tiempo del pulso
  duracion_pulso = pulseIn(pin_echo, HIGH, 25000); // timeout 25ms

  // Si no detectÃ³ nada, devolvemos -1
  if (duracion_pulso == 0) return -1;

  // Convertimos el tiempo a distancia
  int distancia = duracion_pulso * 0.034 / 2;
  return distancia;
}



// ---------------------------------------------------------
// FUNCIONES DE ACTIVACIÃ“N DE GATOS
// ---------------------------------------------------------

void activarGato1() {
  // Motor fuerte â†’ gato que detecta el peligro primero
  analogWrite(motor_gato1, 255);  
}

void activarGato2() {
  analogWrite(motor_gato2, 200);  
}

void activarGato3() {
  analogWrite(motor_gato3, 170);
}

void activarGato4() {
  analogWrite(motor_gato4, 150);
}



// ---------------------------------------------------------
// DESACTIVACIÃ“N LENTA: los gatitos no se calman al tiro
// ---------------------------------------------------------

void desactivarGradual() {

  // Vamos bajando la vibraciÃ³n poquito a poco
  for (int nivel = 255; nivel >= 0; nivel -= 15) {

    analogWrite(motor_gato1, nivel);
    analogWrite(motor_gato2, nivel * 0.8);
    analogWrite(motor_gato3, nivel * 0.6);
    analogWrite(motor_gato4, nivel * 0.5);

    delay(40); // este delay suave da sensaciÃ³n de "calma"
  }
}



// ---------------------------------------------------------
// FUNCIÃ“N PARA APAGAR TODO AL INICIO
// ---------------------------------------------------------

void apagarTodosLosGatos() {
  analogWrite(motor_gato1, 0);
  analogWrite(motor_gato2, 0);
  analogWrite(motor_gato3, 0);
  analogWrite(motor_gato4, 0);
}

Â´Â´Â´

